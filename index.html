<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Budget App</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-red: linear-gradient(135deg, #ff416c, #ff4b2b);
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-color: #333;
            --border-radius: 16px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            justify-content: center;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: var(--text-color);
        }

        .app-container {
            width: 100%;
            max-width: 450px;
            background: var(--card-bg);
            padding: 30px 20px;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            min-height: 700px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        h1 {
            text-align: center;
            font-size: 22px;
            font-weight: 600;
            margin: 0 0 25px 0;
            color: var(--primary-color);
            letter-spacing: 0.5px;
        }

        /* Modern Red Box for Total */
        .total-card {
            background: var(--accent-red);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 15px rgba(255, 75, 43, 0.2);
            transition: transform 0.2s;
        }

        .total-label {
            font-size: 12px;
            text-transform: uppercase;
            opacity: 0.9;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .total-amount {
            font-size: 42px;
            font-weight: 700;
        }

        /* Table Styling */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 80px; /* Space for fixed buttons */
        }

        th {
            text-align: left;
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        /* Centering specific headers */
        th:nth-child(1) { text-align: center; } /* No. */
        th:nth-child(4) { text-align: right; } /* Amount */

        td {
            padding: 12px 0;
            border-bottom: 1px solid #f5f5f5;
            vertical-align: middle;
            position: relative;
        }

        /* Row Hover Effect */
        tbody tr {
            transition: background-color 0.2s;
        }
        tbody tr:hover, tbody tr.selected {
            background-color: #f9faff;
        }

        /* Inputs Styling */
        input {
            width: 100%;
            border: none;
            font-size: 15px;
            background: transparent;
            outline: none;
            color: var(--text-color);
            font-family: inherit;
        }
        
        .date-input { color: #666; font-size: 13px; }
        .amount-input { font-weight: 600; text-align: right; }
        .row-num { color: #aaa; font-size: 13px; text-align: center; }

        /* Hide Number Arrows (Spinners) */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        input[type=number] {
            -moz-appearance: textfield; /* Firefox */
        }

        /* Delete Icon Styling */
        .delete-cell {
            width: 30px;
            text-align: center;
            opacity: 0; /* Hidden by default */
            transition: opacity 0.2s;
        }

        tbody tr:hover .delete-cell, 
        tbody tr.selected .delete-cell {
            opacity: 1; /* Show on hover/select */
        }

        .delete-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-btn svg {
            width: 18px;
            height: 18px;
            stroke: #ff4b2b;
            stroke-width: 2;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
            transition: stroke 0.2s;
        }

        .delete-btn:hover svg {
            stroke: #d32f2f;
        }

        /* Floating Button Bar */
        .button-container {
            position: absolute;
            bottom: 30px;
            left: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
        }

        button {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-add {
            background-color: white;
            border: 1px solid #e0e0e0;
            color: var(--primary-color);
        }

        .btn-save {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 4px 12px rgba(44, 62, 80, 0.3);
        }

        button:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body>

    <div class="app-container">
        <h1>Monthly Expenses</h1>

        <div class="total-card">
            <div class="total-label">Total Spent</div>
            <div class="total-amount" id="totalBox">0</div>
        </div>

        <table id="expenseTable">
            <thead>
                <tr>
                    <th style="width: 10%">No.</th>
                    <th style="width: 25%">Date</th>
                    <th style="width: 35%">Item</th>
                    <th style="width: 20%">Price</th>
                    <th style="width: 10%"></th> 
                </tr>
            </thead>
            <tbody id="tableBody">
                </tbody>
        </table>

        <div class="button-container">
            <button class="btn-add" onclick="addNewRow()">+ Add Row</button>
            <button class="btn-save" onclick="saveData()">Save Changes</button>
        </div>
    </div>

    <script>
        window.onload = function() {
            loadData();
        };

        function calculateTotal() {
            let total = 0;
            const amounts = document.querySelectorAll('.amount-input');
            amounts.forEach(input => {
                const val = parseFloat(input.value);
                if (!isNaN(val)) total += val;
            });
            document.getElementById('totalBox').innerText = total.toLocaleString(); // Adds commas for big numbers
        }

        function selectRow(rowElement) {
            const allRows = document.querySelectorAll('#tableBody tr');
            allRows.forEach(r => r.classList.remove('selected'));
            rowElement.classList.add('selected');
        }

        function addNewRow(dateVal = '', itemVal = '', amountVal = '') {
            const tableBody = document.getElementById('tableBody');
            const rowCount = tableBody.rows.length + 1;
            const row = document.createElement('tr');
            
            row.onclick = function() { selectRow(this); };

            let defaultDate = dateVal;
            if (!defaultDate) {
                const today = new Date();
                defaultDate = today.toISOString().split('T')[0];
            }

            row.innerHTML = `
                <td class="row-num">${rowCount}</td>
                <td><input type="date" class="date-input" value="${defaultDate}"></td>
                <td><input type="text" class="item-input" placeholder="Item" value="${itemVal}"></td>
                <td><input type="number" class="amount-input" placeholder="0" value="${amountVal}" oninput="calculateTotal()"></td>
                <td class="delete-cell">
                    <button class="delete-btn" onclick="deleteRow(this)">
                        <svg viewBox="0 0 24 24">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                    </button>
                </td>
            `;

            tableBody.appendChild(row);
            selectRow(row);
        }

        function deleteRow(btn) {
            const row = btn.parentNode.parentNode;
            
            // Fade out effect
            row.style.opacity = '0';
            setTimeout(() => {
                row.remove();
                renumberRows();
                calculateTotal();
            }, 200); // Wait 200ms for fade
            
            event.stopPropagation();
        }

        function renumberRows() {
            const rows = document.querySelectorAll('#tableBody tr');
            rows.forEach((row, index) => {
                row.querySelector('.row-num').innerText = index + 1;
            });
        }

        function saveData() {
            const rows = document.querySelectorAll('#tableBody tr');
            let data = [];

            rows.forEach(row => {
                const date = row.querySelector('.date-input').value;
                const item = row.querySelector('.item-input').value;
                const amount = row.querySelector('.amount-input').value;
                
                if(date || item || amount) {
                    data.push({ date, item, amount });
                }
            });

            localStorage.setItem('foodBudgetApp', JSON.stringify(data));
            
            // Visual feedback on save
            const saveBtn = document.querySelector('.btn-save');
            const originalText = saveBtn.innerText;
            saveBtn.innerText = "Saved âœ“";
            saveBtn.style.backgroundColor = "#27ae60"; // Green
            setTimeout(() => {
                saveBtn.innerText = originalText;
                saveBtn.style.backgroundColor = ""; // Reset to CSS default
            }, 1500);
        }

        function loadData() {
            const storedData = localStorage.getItem('foodBudgetApp');
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';

            if (storedData) {
                const data = JSON.parse(storedData);
                if (data.length > 0) {
                    data.forEach(item => {
                        addNewRow(item.date, item.item, item.amount);
                    });
                } else {
                    addNewRow(); 
                }
            } else {
                addNewRow(); 
            }
            calculateTotal(); 
        }
    </script>
</body>
</html>
